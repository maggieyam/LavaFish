{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/Users/tony/Desktop/App_Academy/Mern/menutube/frontend/src/components/posts/create_post_form.js\";\nimport React from 'react';\nimport \"react-loader-spinner/dist/loader/css/react-spinner-loader.css\";\nimport 'semantic-ui-css/semantic.min.css';\nimport './create_post_form.css';\nimport Loader from 'react-loader-spinner';\nimport { uploadFile } from 'react-s3';\nimport { Dropdown } from 'semantic-ui-react';\n\nconst aws = require('../../config/aws');\n\nconst config = {\n  bucketName: aws.BUCKET_NAME,\n  region: 'us-east-1',\n  accessKeyId: aws.ID,\n  secretAccessKey: aws.SECRET\n};\n\nclass CreatePostForm extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      title: \"\",\n      fileTooLarge: false\n    };\n    this.changeTitle = this.changeTitle.bind(this);\n    this.errors = this.errors.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.loaderSpinner = this.loaderSpinner.bind(this);\n    this.fileLoader = /*#__PURE__*/React.createRef();\n    this.handleTag = this.handleTag.bind(this);\n    this.testVideo = /*#__PURE__*/React.createRef();\n    this.setupVideo = this.setupVideo.bind(this);\n    this.checkVideoDuration = this.checkVideoDuration.bind(this);\n  }\n\n  componentDidMount() {\n    this.props.fetchTags();\n  }\n\n  changeTitle(e) {\n    e.preventDefault();\n    this.setState({\n      title: e.currentTarget.value\n    });\n  }\n\n  errors(field) {\n    if (this.props.errors[field]) {\n      return /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"posting-error\",\n        children: this.props.errors[field]\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 45,\n        columnNumber: 14\n      }, this);\n    }\n\n    return;\n  }\n\n  handleTag(e, data) {\n    const bools = {};\n    data.value.map(category => bools[category] = true);\n    this.setState({\n      [data.placeholder.toLowerCase()]: bools\n    });\n  }\n\n  handleSubmit(e) {\n    e.preventDefault();\n    const video = this.fileLoader.current.files[0];\n    this.props.loadingOn();\n    uploadFile(video, config).then(data => {\n      const post = {\n        title: this.state.title,\n        url: data.location,\n        nutrition: this.state.nutrition,\n        diet: this.state.diet,\n        ingredients: this.state.ingredients\n      };\n      this.props.createPost(post).then(() => {\n        this.props.loadingOff();\n        this.props.clearPostErrors();\n        this.props.history.push('/feed');\n      });\n    }).catch(err => {\n      this.props.loadingOff();\n      console.log(err);\n    });\n  }\n\n  loaderSpinner() {\n    if (this.props.loading) {\n      return /*#__PURE__*/_jsxDEV(Loader, {\n        type: \"Grid\",\n        color: \"#ee82ee\",\n        height: 100,\n        width: 100\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 9\n      }, this);\n    }\n\n    return;\n  }\n\n  optionify(category) {\n    const options = Object.keys(category).map(tag => {\n      return {\n        key: tag,\n        text: tag[0].toUpperCase() + tag.slice(1),\n        value: tag\n      };\n    });\n    options.pop();\n    return options;\n  }\n\n  setupVideo(e) {\n    if (e.currentTarget.files.length > 0) {\n      const url = URL.createObjectURL(e.currentTarget.files[0]);\n      this.testVideo.current.setAttribute('src', url);\n    }\n  }\n\n  checkVideoDuration(e) {\n    this.setState({\n      fileTooLarge: this.testVideo.current.duration > 1200\n    });\n  }\n\n  render() {\n    if (!this.props.diet) return null;\n    const fileSizeError = !this.state.fileTooLarge ? null : /*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"file-size-error\",\n      children: /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Videos can only be 20 minutes or less.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 7\n    }, this);\n    return /*#__PURE__*/_jsxDEV(\"form\", {\n      className: \"post-form\",\n      onSubmit: this.handleSubmit,\n      children: [this.loaderSpinner(), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"title-input-div\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"post-title\",\n          children: \"Enter a title:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 129,\n          columnNumber: 7\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          id: \"post-title\",\n          type: \"text\",\n          value: this.state.title,\n          onChange: this.changeTitle\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 8\n        }, this), this.errors(\"title\")]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"vid-input-div\",\n        children: /*#__PURE__*/_jsxDEV(\"input\", {\n          id: \"video-input\",\n          type: \"file\",\n          ref: this.fileLoader,\n          onChange: this.setupVideo,\n          accept: \"video/*\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 139,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 7\n      }, this), fileSizeError, /*#__PURE__*/_jsxDEV(\"video\", {\n        id: \"test-video\",\n        ref: this.testVideo,\n        onCanPlayThrough: this.checkVideoDuration\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        children: [\" Diet/Restrictions:\", /*#__PURE__*/_jsxDEV(Dropdown, {\n          placeholder: \"Diet\",\n          fluid: true,\n          multiple: true,\n          search: true,\n          selection: true,\n          options: this.optionify(this.props.diet),\n          onChange: this.handleTag\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 156,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 155,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        children: [\" Nutrition:\", /*#__PURE__*/_jsxDEV(Dropdown, {\n          placeholder: \"Nutrition\",\n          fluid: true,\n          multiple: true,\n          search: true,\n          selection: true,\n          options: this.optionify(this.props.nutrition),\n          onChange: this.handleTag\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 168,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 167,\n        columnNumber: 10\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        children: [\"Ingredients:\", /*#__PURE__*/_jsxDEV(Dropdown, {\n          placeholder: \"Ingredients\",\n          fluid: true,\n          multiple: true,\n          search: true,\n          selection: true,\n          options: this.optionify(this.props.ingredients),\n          onChange: this.handleTag\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 180,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 179,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        id: \"submit-post\",\n        type: \"submit\",\n        value: \"Submit Post\",\n        disabled: this.state.fileTooLarge\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 190,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nexport default CreatePostForm;","map":{"version":3,"sources":["/Users/tony/Desktop/App_Academy/Mern/menutube/frontend/src/components/posts/create_post_form.js"],"names":["React","Loader","uploadFile","Dropdown","aws","require","config","bucketName","BUCKET_NAME","region","accessKeyId","ID","secretAccessKey","SECRET","CreatePostForm","Component","constructor","props","state","title","fileTooLarge","changeTitle","bind","errors","handleSubmit","loaderSpinner","fileLoader","createRef","handleTag","testVideo","setupVideo","checkVideoDuration","componentDidMount","fetchTags","e","preventDefault","setState","currentTarget","value","field","data","bools","map","category","placeholder","toLowerCase","video","current","files","loadingOn","then","post","url","location","nutrition","diet","ingredients","createPost","loadingOff","clearPostErrors","history","push","catch","err","console","log","loading","optionify","options","Object","keys","tag","key","text","toUpperCase","slice","pop","length","URL","createObjectURL","setAttribute","duration","render","fileSizeError"],"mappings":"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","sourcesContent":["import React from 'react';\nimport \"react-loader-spinner/dist/loader/css/react-spinner-loader.css\";\nimport 'semantic-ui-css/semantic.min.css'\nimport './create_post_form.css'\nimport Loader from 'react-loader-spinner';\nimport { uploadFile } from 'react-s3';\nimport { Dropdown } from 'semantic-ui-react';\nconst aws = require('../../config/aws');\n\nconst config = {\n  bucketName: aws.BUCKET_NAME,\n  region: 'us-east-1',\n  accessKeyId: aws.ID,\n  secretAccessKey: aws.SECRET,\n}\n\nclass CreatePostForm extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = { title: \"\", fileTooLarge: false }\n    this.changeTitle = this.changeTitle.bind(this);\n    this.errors = this.errors.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.loaderSpinner = this.loaderSpinner.bind(this);\n    this.fileLoader = React.createRef();\n    this.handleTag = this.handleTag.bind(this);\n    this.testVideo = React.createRef();\n    this.setupVideo = this.setupVideo.bind(this);\n    this.checkVideoDuration = this.checkVideoDuration.bind(this);\n  }\n\n  componentDidMount(){\n    this.props.fetchTags()\n  }\n\n  \n  changeTitle(e){\n    e.preventDefault();\n    this.setState({title: e.currentTarget.value});\n  }\n\n  errors(field){\n    if (this.props.errors[field]) {\n      return <p className=\"posting-error\">{this.props.errors[field]}</p>\n    }\n    return \n  }\n\n  handleTag(e, data){\n    const bools = {};\n    data.value.map(category => bools[category] = true);\n    this.setState({[data.placeholder.toLowerCase()]: bools })\n  }\n\n  \n  handleSubmit(e){\n    e.preventDefault();\n\n    const video = this.fileLoader.current.files[0]\n    this.props.loadingOn();\n    uploadFile(video, config).then(\n      data => {\n\n        const post = {\n          title: this.state.title,\n          url: data.location,\n          nutrition: this.state.nutrition,\n          diet: this.state.diet,\n          ingredients: this.state.ingredients\n        }\n        this.props.createPost(post).then(() => {\n           this.props.loadingOff();\n           this.props.clearPostErrors();\n           this.props.history.push('/feed')\n        })\n      }\n\n    ).catch(err => {\n      this.props.loadingOff()\n      console.log(err)\n    })\n  }\n\n  loaderSpinner(){\n    if (this.props.loading){\n      return (\n        <Loader type=\"Grid\" color=\"#ee82ee\" height={100} width={100} />          \n      )\n    }\n    return\n  }\n\n  optionify(category) {\n    const options = Object.keys(category).map(tag => {\n      return {key: tag, text: tag[0].toUpperCase() + tag.slice(1), value: tag}\n    })\n    options.pop();\n    return options\n  }\n\n  setupVideo(e) {\n    if (e.currentTarget.files.length > 0) {\n      const url = URL.createObjectURL(e.currentTarget.files[0]);\n      this.testVideo.current.setAttribute('src', url);\n    }\n  }\n\n  checkVideoDuration(e) {\n    this.setState({\n      fileTooLarge: this.testVideo.current.duration > 1200\n    });\n  }\n\n  render() {\n    if (!this.props.diet) return null;\n\n    const fileSizeError = !this.state.fileTooLarge ? null : (\n      <div id=\"file-size-error\">\n        <p>Videos can only be 20 minutes or less.</p>\n      </div>\n    );\n\n    return (\n      <form className=\"post-form\" onSubmit={this.handleSubmit}>\n        {this.loaderSpinner()}\n\n      <div className=\"title-input-div\">\n      <label htmlFor=\"post-title\">Enter a title:</label>\n       <input\n        id=\"post-title\" \n        type=\"text\" \n        value={this.state.title}\n        onChange={this.changeTitle}/>  \n        {this.errors(\"title\")}\n      </div>\n\n      <div className=\"vid-input-div\">\n          <input \n          id=\"video-input\"\n          type=\"file\" \n          ref={this.fileLoader}\n          onChange={this.setupVideo}\n          accept=\"video/*\"/>\n      </div>\n\n      {fileSizeError}\n\n      <video\n        id=\"test-video\"\n        ref={this.testVideo}\n        onCanPlayThrough={this.checkVideoDuration}\n      />\n      \n        <label> Diet/Restrictions: \n          <Dropdown \n            placeholder='Diet'\n            fluid\n            multiple\n            search\n            selection\n            options={this.optionify(this.props.diet)}\n            onChange={this.handleTag}\n          />\n        </label>\n\n         <label> Nutrition: \n        <Dropdown \n          placeholder='Nutrition'\n          fluid\n          multiple\n          search\n          selection\n          options={this.optionify(this.props.nutrition)}\n          onChange={this.handleTag}\n        />\n        </label>\n\n        <label>Ingredients:\n        <Dropdown \n          placeholder='Ingredients'\n          fluid\n          multiple\n          search\n          selection\n          options={this.optionify(this.props.ingredients)}\n          onChange={this.handleTag}\n        /> \n        </label>\n        <input id=\"submit-post\" type=\"submit\" value=\"Submit Post\"\n          disabled={this.state.fileTooLarge}\n        />\n      </form>    \n    )\n  }\n\n}\n\nexport default CreatePostForm;\n\n"]},"metadata":{},"sourceType":"module"}